'use strict';(function(){if('from' in Array==!1){Array.from=function(collection){return Array.prototype.slice.call(collection)}}
if('includes' in Array.prototype==!1){Array.prototype.includes=function(needle){return this.reduce(function(found,currentValue){return found||currentValue===needle},!1)}}
if('includes' in String.prototype==!1){String.prototype.includes=function(needle,offset){offset=isNaN(parseInt(offset))?0:Math.min(Math.max(0,parseInt(offset)),needle.length-1);return this.indexOf(needle,offset)!==-1}}
var addEvent;if('addEventListener' in window){addEvent=function(obj,event,fn,opt){obj.addEventListener(event,fn,opt)}}else if('attachEvent' in window){addEvent=function(obj,event,fn,opt){obj.attachEvent('on'+event,fn)}}else{addEvent=function(obj,event,fn,opt){}}
var CustomEvent;if(typeof window.CustomEvent!=="function"){function CustomEvent(event,params){params=params||{bubbles:!1,cancelable:!1,detail:null};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}}else{CustomEvent=window.CustomEvent}
if('padStart' in String.prototype==!1){String.prototype.padStart=function padStart(len,padding){len=len|0;padding=(padString===undefined)?padding+"":" ";if(this.length>len){return this}else{len=len-this.length;if(len>len.length){padding+=padding.repeat(len/padding.length)}
return padding.slice(0,len)+this}}}
var hl=[];for(var i=0;i<256;i++){hl[i]=((i>>4)&15).toString(16)+(i&15).toString(16)}
var Utils={toggleClass:function(element,className,forceState){if(!element||!element.classList){console.error('[CCM] Cannot toggle class %s on %s',className,element===null?element:typeof element)}
var newState=typeof forceState=='boolean'?forceState:element.classList.contains(className)==!1;newState?element.classList.add(className):element.classList.remove(className)},enableButtons:function(element){Array.from(element.getElementsByTagName('BUTTON')).forEach(function(button){button.disabled=!1})},disableButtons:function(element){Array.from(element.getElementsByTagName('BUTTON')).forEach(function(button){button.disabled=!0})},extractDomain:function(url){var match=url.match(/^(?:https?:)?\/\/([^\/]+)/);return match?match[1]:''},triggerCustomEvent:function(node,name,detail){var evt;try{evt=new CustomEvent(name,{detail:detail})}catch(_){evt=document.createEvent('CustomEvent');evt.initCustomEvent(name,!0,!1,detail)}
node.dispatchEvent(evt)},isJavaScript:function(script){return(!script.type||/(application|text)\/(x-)?(java|ecma|j|live)script(1.[0-5])?/.test(script.type.toLowerCase())||script.type.toLowerCase()=='module')},checkIsExternal:function(url){if(!url){return!1}
var dblSlashIdx=url.search('//');if(dblSlashIdx<0||dblSlashIdx>16){return!1}
var localHostIdx=url.search('//'+location.host+'/');if(localHostIdx===dblSlashIdx){return!1}
var mainDomain=location.hostname;mainDomain=mainDomain.replace(/\.$/,'');mainDomain=mainDomain.replace(/^.*\.([^.]+\.[^.]+)$/,'$1');var domainRegExp=new RegExp('//[^/]*\\b'+mainDomain.replace(/([.\\])/g,'\\$1')+'/');if(url.search(domainRegExp)!==-1){return!1}
if(url.includes("\/ccm19\/public\/ccm19.js")){return!1}
return!0},hash:function(str){var c,i,l=str.length,t0=0,v0=0x2325,t1=0,v1=0x8422,t2=0,v2=0x9ce4,t3=0,v3=0xcbf2;for(i=0;i<l;i++){c=str.charCodeAt(i);if(c<128){v0^=c}else if(c<2048){v0^=(c>>6)|192;t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535;v0^=(c&63)|128}else if(((c&64512)==55296)&&(i+1)<l&&((str.charCodeAt(i+1)&64512)==56320)){c=65536+((c&1023)<<10)+(str.charCodeAt(++i)&1023);v0^=(c>>18)|240;t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535;v0^=((c>>12)&63)|128;t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535;v0^=((c>>6)&63)|128;t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535;v0^=(c&63)|128}else{v0^=(c>>12)|224;t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535;v0^=((c>>6)&63)|128;t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535;v0^=(c&63)|128}
t0=v0*435;t1=v1*435;t2=v2*435;t3=v3*435;t2+=v0<<8;t3+=v1<<8;t1+=t0>>>16;v0=t0&65535;t2+=t1>>>16;v1=t1&65535;v3=(t3+(t2>>>16))&65535;v2=t2&65535}
return hl[v3>>8]+hl[v3&255]+hl[v2>>8]+hl[v2&255]+hl[v1>>8]+hl[v1&255]+hl[v0>>8]+hl[v0&255]}};function CookieConsentManagement(){this.init()}
CookieConsentManagement.prototype={constructor:CookieConsentManagement,initialized:!1,shouldReport:!1,countedView:!1,container:null,controlPanel:null,widget:null,widgetUrl:null,widgetUrls:{"de_DE":"https:\/\/www.tradingbrothers.com\/ccm19\/public\/widget?apiKey=8662deeca87e5929ab9e3de6d9d0def93da5a2f8828890f5&domain=c2e7bbc&lang=de_DE"},locale:"de_DE",statisticsUrl:"https:\/\/www.tradingbrothers.com\/ccm19\/public\/statistics\/consent?apiKey=8662deeca87e5929ab9e3de6d9d0def93da5a2f8828890f5&domain=c2e7bbc",pageCheckUrl:"https:\/\/www.tradingbrothers.com\/ccm19\/public\/page_check\/report?apiKey=8662deeca87e5929ab9e3de6d9d0def93da5a2f8828890f5&domain=c2e7bbc",cronUrl:"https:\/\/www.tradingbrothers.com\/ccm19\/public\/cron?apiKey=8662deeca87e5929ab9e3de6d9d0def93da5a2f8828890f5&domain=c2e7bbc",origin:"https:\/\/www.tradingbrothers.com",cssFiles:["https:\/\/www.tradingbrothers.com\/ccm19\/public\/ccm19.css?apiKey=8662deeca87e5929ab9e3de6d9d0def93da5a2f8828890f5&domain=c2e7bbc&theme=5af884c&v=1593702315"],jsFiles:[],isActive:!0,deleteAllCookiesConfig:!1,deleteAllCookiesReload:!1,cookieDataActive:["Facebook Cookie","_fbp","Google Analytics","_gat_gtag_UA_xxxxxx_xx","_gid","__utma","__utmb","__utmc","__utmt","__utmz","ccm_consent","papoo_session_7328"],cookies:{consent:'ccm_consent',},cookieLifetime:365,ucid:"2c4f5b1ee831bd34170a74512eae273f10a151289f0d3a0111d2e84b529ec905",settingsIconEnabled:!1,settingsIconTarget:"purpose",repository:{},behavior:{"respectDoNotTrack":!0,"noConsentRequired":!1},cookiesEmbedded:[],purposesEmbedded:[],forceOpenWidget:!1,domWatcher:null,iframes:[],blockableScripts:[],foundScriptCookies:{},inEval:!1,blockIframes:!1,blockScripts:!1,blockSameDomainScripts:!0,blockInlineScripts:!0,blockPurposeScriptMarkers:{"a717ff5":[],"cdcbd7c":[]},allowedScripts:["dcb15680f66c9dbb","4c2e30d6ae1b2a1f","212d349cd28fbf07","9f5e0356add1b6ae","4725e999e7077afe","7ad63b55a0b8a349","4dad44133965576e","93dccc4b98337362","5dad54a6b198540d","e89fec5a206bae42","ce65b7ebae1701c7","cfeb275520b935bc","c6d340076a93368a","a42396e1bf1ccb95","1f4390ab62d704d5","78f4cde99ed17673","577232625107044e","28af8c9c09023b3f","907e57681203ed9f","1540d912c907b105","e8d700cae3300633","98dc94e944d9e5e9","de47e1085c0a430e","73dbc585c6d0b6a1","a2f04004f6cb8cf1","1d9fcfad2987f7b0","a08d25022adf02ad","16e1444240175624","c0a38f43f60b7900","564e53b885820f92","36812fad037fd61f","f3bd83ce37a68b8f","773fbb68b2747deb","b17677519657af91","77f26d1a97870a4b","02a73e86d3072085","4e68c1cfa350dac5","4c83496977b223d9","eb53c95b4755fa32","c33823c2e105ec15","931f53781aa8231f","b2a18c44fc8ebdce","ed02f06d22e42e26","cfdfe4687d421abf","3a723f5130e65c9b","460e4a77d703e1ad","015f5678d7783419","5d130abd75ee84fd","bb905019bbf6332f","735d98eb41055e4a","ffa580ec3cc5cf1c","c0e31c63531fbbb1","32e4eb0c6e74f7f5","5681e405e0a7e691","ceb2806ed7cef247","a32041baeabfc655","26aa81eb28695be2","4c2e84cb0387a338","23736723212a4f55","384c05401bcf84dd","e6d5f87c94fe2f21","2be4ce17285882a2","86641f31c5abb911","892a024d5f51bf20","221fe546441735cf","f33bfdd77964f212","d3431a04afe50357","b0af4e2b8d66d5ed","aeefe739152304d1","3128086a1dbfc813","c9ea496a829b1012","a11f08e01b543a5f","92d48e1a21167817","3737d9f7d3fe3b9c","7f5f3c4f8f9ccff8","32bb704009f300fd","1ac2b177449b89e8","00674a8437001f1f","d49f732d14d1d39d","1dbbba98a6e472ed","cf8b58dd86a7eebb","7e9fb85a7cff5ea4","f88044cacb6bf6a4","048f7e39a37be3fe","36424de9822a768d","c6d559f6afb87fcb","116f2dffc75ab924","a54b3c6b5b816840","20ca88ec65db5c63","3e6db1cb95c2ead8","2b514556bfbeddf5","8171099b502c858b","c3bc1e4dacfd9765","7ccd68b92403f736","6ff44504737bc199","ca463aca600df964","b22909711d3dc35b","4b195348a5a18a5e","514aafd50c21b8ee","08775b2116f97250"],allowedScriptMarkers:[],allowedIframeMarkers:[],getCookies:function(){return document.cookie.split(';').filter(function(chunk){return chunk.trim().length>0}).map(function(cookie){var parts=cookie.trim().split('=');return{name:parts[0],value:parts[1],}})},getCookie:function(name){var self=this;var result=null;if('localStorage' in window&&'getItem' in window.localStorage){result=window.localStorage.getItem(name);if(result!==null){try{return JSON.parse(result)}catch(error){return{}}}}
return this.getCookies().reduce(function(value,cookie){try{return cookie.name===name?self.decodeCookieValue(cookie.value):value}catch(error){return{}}},null)},setCookie:function(name,value,options){if(name===undefined||value===undefined){throw new Error('Undefined name or value not allowed for cookies.')}
options=typeof options==='object'?options:{};if(options.noLocalStorage||!('localStorage' in window)||!('setItem' in window.localStorage)){var chunks=[name+'='+this.encodeCookieValue(value),];if(options.path){chunks.push('path='+options.path)}
if(options.expires){chunks.push('expires='+options.expires)}
if(options.sameSite){chunks.push('SameSite='+options.sameSite)}else{chunks.push('SameSite=Lax')}
if(options.secure){chunks.push('Secure')}
document.cookie=chunks.join(';')}else{window.localStorage.setItem(name,JSON.stringify(value))}},encodeCookieValue:function(value){return encodeURIComponent(btoa(JSON.stringify(value)))},decodeCookieValue:function(value){return JSON.parse(atob(decodeURIComponent(value)))},isBotBrowser:function(){return/(bot\b|BOT\b|Bot\b|BingPreview| \(\+http)/.test(navigator.userAgent)},isDoNotTrackEnabledInBrowser:function(){return window.doNotTrack&&window.doNotTrack==1||navigator.doNotTrack&&[1,'1','yes'].includes(navigator.doNotTrack)||navigator.msDoNotTrack&&navigator.msDoNotTrack==1||typeof window.external==='object'&&'msTrackingProtectionEnabled' in window.external&&window.external.msTrackingProtectionEnabled()||!1},ajax:function(url,options){options=typeof options==='object'?options:{};var body=options.body;var async=typeof options.async==='boolean'?options.async:!0;var method=options.method||'GET';var xhr=new XMLHttpRequest();var self=this;xhr.onreadystatechange=function(){if(this.readyState==4){this.status==200?typeof options.success==='function'&&options.success.call(self,this.responseText):typeof options.failure==='function'&&options.failure.call(self);typeof options.done==='function'&&options.done.call(self)}};xhr.open(method,url,async);xhr.setRequestHeader('X-Requested-With','XMLHttpRequest');if(['POST','PUT','PATCH'].includes(method)){var contentType=options.contentType||'application/x-www-form-urlencoded';if(contentType==='application/json'){body=JSON.stringify(body)}
xhr.setRequestHeader('Content-Type',contentType)}
if('headers' in options){for(var key in options.headers){xhr.setRequestHeader(key,options.headers[key]+'')}}
xhr.send(body)},injectCss:function(){this.cssFiles.forEach(function(url){var link=document.createElement('LINK');link.setAttribute('href',url);link.setAttribute('rel','stylesheet');link.setAttribute('type','text/css');document.head.appendChild(link)})},injectJs:function(){this.jsFiles.forEach(function(url){var script=document.createElement('SCRIPT');script.setAttribute('src',url);document.head.appendChild(script)})},executeScript:function(script){var success=!0;if(script.hasAttribute('src')){var clone=document.createElement('SCRIPT');clone.setAttribute('data-ccm-injected','true');Array.from(script.attributes).forEach(function(attr){clone.setAttribute(attr.name,attr.value)});if(script.parentElement){script.parentElement.removeChild(script)}
document.body.appendChild(clone)}else{try{this.inEval=!0;script.setAttribute('data-ccm-injected','true');document.body.appendChild(script);eval.call(window,script.textContent);this.inEval=!1}catch(error){this.inEval=!1;console.error('[CCM] Script execution: ('+error.name+') '+error.message);return!1}}
return!0},embedCookie:function(cookieId){if(this.cookiesEmbedded.includes(cookieId)){return}
var cookie=this.repository[cookieId];if(cookie===undefined){console.error('[CCM] Embedding cookie: Entity '+cookieId+' does not exist.');return}
console.info('[CCM] Injecting script \''+cookie.name+'\'');var container=document.createElement('DIV');container.innerHTML=cookie.code;while(container.children.length>0){var child=container.firstElementChild;if(child.tagName==='SCRIPT'){this.executeScript(child)}else{document.body.appendChild(child)}}
this.cookiesEmbedded.push(cookieId);Utils.triggerCustomEvent(window,'ccm19CookieAccepted',cookie)},embedPurpose:function(purposeId){var self=this;if(this.purposesEmbedded.includes(purposeId)){return}
this.purposesEmbedded.push(purposeId);for(var cookieId in this.repository){if(this.repository[cookieId].purpose===purposeId){this.embedCookie(cookieId)}}
this.blockableScripts.forEach(function(node){if(!node.ccm_purposes){return}
if(node.ccm_purposes.includes(purposeId)){var shouldActivate=node.ccm_purposes.reduce(function(result,purposeId){return result&&self.purposesEmbedded.includes(purposeId)},!0);if(shouldActivate){var name=node.src?node.src:node.innerText.trim().replace(/\s\s+/g,' ').substring(0,40);console.debug('[CCM] reactivated script %s',name);self.executeScript(node)}}})},jumpTo:function(id,event){event=event||window.event;event.preventDefault();window.location.hash=id;history.back&&history.back();window.requestAnimationFrame(function(){var el=document.getElementById(id);el&&el.scrollIntoView&&el.scrollIntoView()})},onSettingsIconClicked:function(event){event=event||window.event;event.preventDefault();this.hideSettingsIcon();switch(this.settingsIconTarget){case 'main':this.openWidget();break;case 'purpose':default:this.openControlPanel();break}},showSettingsIcon:function(){if(this.settingsIconEnabled==!1){return}
Array.from(this.container.querySelectorAll('.ccm-settings-summoner')).forEach(function(element){element.classList.remove('ccm-hide');element.classList.add('show')})},hideSettingsIcon:function(){if(this.settingsIconEnabled==!1){return}
Array.from(this.container.querySelectorAll('.ccm-settings-summoner')).forEach(function(element){element.classList.remove('show');element.classList.add('ccm-hide')})},updateBlocking:function(){var blockingModals=this.getActiveModals().filter(function(modal){return modal.classList.contains('blocking')});Utils.toggleClass(document.body,'ccm-blocked',blockingModals.length>0);blockingModals.length>0?this.hideSettingsIcon():this.showSettingsIcon()},isModalActive:function(){return Array.from(this.container.getElementsByClassName('ccm-modal')).reduce(function(active,modal){return active||modal.classList.contains('show')},!1)},getActiveModals:function(){return Array.from(this.container.getElementsByClassName('ccm-modal')).filter(function(modal){return modal.classList.contains('show')},!1)},showModal:function(target,updateBlocking){if(target==null||target.classList.contains('ccm-modal')==!1){return}
updateBlocking=typeof updateBlocking=='boolean'?updateBlocking:!0;if(target.classList.contains('ccm-details')){var ucidShort=this.getUniqueCookieId().substr(0,16);Array.from(target.getElementsByClassName('ccm-user-info--ucid--value')).forEach(function(element){element.textContent=ucidShort})}
target.classList.add('show');target.setAttribute('aria-hidden','false');target.style.display='';Utils.enableButtons(target);if(updateBlocking){this.updateBlocking()}},hideModal:function(target,updateBlocking){if(target==null||target.classList.contains('ccm-modal')==!1){return}
updateBlocking=typeof updateBlocking=='boolean'?updateBlocking:!0;target.classList.remove('show');target.setAttribute('aria-hidden','true');target.style.display='none';Utils.disableButtons(target);if(updateBlocking){this.updateBlocking()}},closeAllModals:function(){var self=this;Array.from(this.container.getElementsByClassName('ccm-modal')).forEach(function(modal){self.hideModal.call(self,modal,!1)});this.updateBlocking()},openControlPanel:function(){this.showModal(this.controlPanel)},closeControlPanel:function(){this.hideModal(this.controlPanel)},openWidget:function(){if(this.isActive){this.showModal(this.widget)}},closeWidget:function(){this.hideModal(this.widget)},onModalCloseButtonClicked:function(event){var target=event.target;while(target!==null&&target.classList.contains('ccm-modal')==!1){target=target.parentElement}
this.hideModal(target)},switchLocale:function(locale){if(locale in this.widgetUrls){this.locale=locale;this.widgetUrl=this.widgetUrls[locale];if(this.widget){this.widget.classList.add('ccm-widget--loading')}
this.forceOpenWidget=!0;this.build()}else{console.error('[CCM] Could not switch to unknown locale "'+locale+'"')}},selectAllPurposes:function(){var self=this;var purposes=Array.from(this.controlPanel.getElementsByClassName('ccm-control-panel--purpose'));purposes.forEach(function(purpose){var purposeId=purpose.dataset.purpose;var checkbox=self.container.querySelector('#ccm-purpose-'+purposeId);checkbox&&(checkbox.checked=!0)})},selectedPurposes:function(){var self=this;var purposes=Array.from(this.controlPanel.getElementsByClassName('ccm-control-panel--purpose'));return purposes.filter(function(purpose){var purposeId=purpose.dataset.purpose;var mandatory=purpose.classList.contains('mandatory');var checkbox=self.container.querySelector('#ccm-purpose-'+purposeId);if(checkbox===null){console.error('[CCM] State for purpose '+purposeId+' could not be determined.');return!1}
return checkbox.checked||mandatory}).map(function(purpose){return purpose.dataset.purpose})},loadScripts:function(){var self=this;var purposes=this.selectedPurposes();purposes.forEach(function(purposeId){self.embedPurpose(purposeId)});this.deleteAllCookies("after",purposes);this.showSettingsIcon()},getUniqueCookieId:function(){var storage=this.getCookie(this.cookies.consent)||{};return storage.ucid||this.ucid},logConsentSettings:function(){var storage=this.getCookie(this.cookies.consent)||{};this.ajax(this.statisticsUrl,{method:'POST',contentType:'application/json',body:{ucid:this.getUniqueCookieId(),consent:storage.consent,purposes:this.selectedPurposes(),},})},saveSettings:function(){var storage=this.getCookie(this.cookies.consent)||{};var options={path:'/',};this.loadScripts();if(this.cookieLifetime>0){options.expires=new Date(Date.now()+(this.cookieLifetime*86400000)).toUTCString()}
options.secure=(location.protocol=='https:');storage.ucid=this.getUniqueCookieId();storage.consent=!0;storage.purposes=this.selectedPurposes();this.setCookie(this.cookies.consent,storage,options);this.logConsentSettings();this.closeAllModals()},onConsentButtonClicked:function(event){event=event||window.event;var button=event.target;var trusted=('isTrusted' in event)?event.isTrusted:!0;if(!trusted){console.warn('[CCM] Manipulated click on consent button detected and ignored.');return}
if(button.dataset.fullConsent=='true'){this.selectAllPurposes()}
this.saveSettings()},onDeclineButtonClicked:function(event){event=event||window.event;var button=event.target;this.setAllPurposes(!1);this.saveSettings()},presetPurposes:function(){var self=this;var storage=this.getCookie(this.cookies.consent)||{};var choices=storage.purposes||[];var purposes=Array.from(this.controlPanel.getElementsByClassName('ccm-control-panel--purpose'));purposes.forEach(function(purpose){var purposeId=purpose.dataset.purpose;var mandatory=purpose.classList.contains('mandatory');var checkbox=self.container.querySelector('#ccm-purpose-'+purposeId);var enablePurpose=!1;if(self.consentGiven()){enablePurpose=choices.includes(purposeId)}else{enablePurpose=self.behavior.respectDoNotTrack==!1||self.isDoNotTrackEnabledInBrowser()==!1;enablePurpose=!1}
checkbox.checked=enablePurpose||mandatory})},setAllPurposes:function(enablePurposes){var self=this;var purposes=Array.from(this.controlPanel.getElementsByClassName('ccm-control-panel--purpose'));purposes.forEach(function(purpose){var purposeId=purpose.dataset.purpose;var mandatory=purpose.classList.contains('mandatory');var checkbox=self.container.querySelector('#ccm-purpose-'+purposeId);checkbox.checked=enablePurposes||mandatory})},consentGiven:function(){var storage=this.getCookie(this.cookies.consent)||{};return storage.consent||!1},registerControls:function(){var self=this;Array.from(this.container.querySelectorAll('.ccm-settings-summoner > .ccm-settings-summoner--link')).forEach(function(element){addEvent(element,'click',self.onSettingsIconClicked.bind(self))});Array.from(this.container.querySelectorAll('[data-jump-to]')).forEach(function(element){addEvent(element,'click',self.jumpTo.bind(self,element.dataset.jumpTo))});Array.from(this.container.querySelectorAll('[data-ccm-modal]')).forEach(function(element){addEvent(element,'click',function(){self.showModal(document.getElementById(element.dataset.ccmModal))})});Array.from(this.container.getElementsByClassName('ccm-modal--close')).forEach(function(element){addEvent(element,'click',self.onModalCloseButtonClicked.bind(self))});Array.from(this.container.getElementsByClassName('ccm--save-settings')).forEach(function(element){addEvent(element,'click',self.onConsentButtonClicked.bind(self))});Array.from(this.container.getElementsByClassName('ccm--decline-cookies')).forEach(function(element){element.addEventListener('click',self.onDeclineButtonClicked.bind(self))});Array.from(this.container.getElementsByClassName('ccm-widget--language-select')).forEach(function(element){addEvent(element,'change',function(){self.switchLocale(this.value)})})},build:function(){if(!this.container){this.container=document.createElement('DIV');this.container.classList.add('ccm-root')}
if(!this.widgetUrl){this.widgetUrl=this.widgetUrls[this.locale]}
var headers={};if(this.isActive&&!this.countedView&&!this.behavior.noConsentRequired&&!this.isBotBrowser()&&!this.consentGiven()){headers['X-CCM19State']='new-view';this.countedView=!0}
this.ajax(this.widgetUrl,{method:'GET',headers:headers,success:function(response){this.container.innerHTML=response;this.controlPanel=this.container.querySelector('#ccm-control-panel');this.widget=this.container.querySelector('#ccm-widget');this.repository=JSON.parse(this.container.querySelector('.ccm-script-repository').textContent);this.closeAllModals();this.registerControls();this.presetPurposes();if(this.forceOpenWidget){this.forceOpenWidget=!1;this.openWidget()}else if(this.isBotBrowser()){this.setAllPurposes(!1);if(document.body){this.loadScripts()}else{addEvent(window,'DOMContentLoaded',this.loadScripts.bind(this))}}else if(this.behavior.noConsentRequired){var dnt=(this.behavior.respectDoNotTrack&&this.isDoNotTrackEnabledInBrowser());this.setAllPurposes(!dnt);if(document.body){this.loadScripts()}else{addEvent(window,'DOMContentLoaded',this.loadScripts.bind(this))}}else if(this.consentGiven()){if(document.body){this.loadScripts()}else{addEvent(window,'DOMContentLoaded',this.loadScripts.bind(this))}}else{this.openWidget()}},failure:function(){this.closeAllModals();this.container.innerHTML='<div class="ccm-widget">Error while loading resource, please try again later.</div>'},})},restoreIframe:function(iframe){if(iframe.dataset.ccmSrc!==''){iframe.src=iframe.dataset.ccmSrc;iframe.dataset.ccmSrc='';iframe.style.height=iframe.dataset.initialHeight+'px';iframe.dataset.initialHeight='';window.requestAnimationFrame(function(){iframe.style.height=''})}},onPostMessage:function(event){var self=this;if(event.origin!=this.origin||typeof event.data!='object'){return}
var iframe=this.iframes.reduce(function(iframe,currentItem){if(event.source===currentItem.contentWindow){return currentItem}
return iframe},null);if(iframe==null){return}
var action=typeof event.data.action=='string'?event.data.action:'';switch(action){case 'updateHeight':if(typeof event.data.innerHeight=='number'){iframe.dataset.initialHeight=iframe.clientHeight;iframe.style.height=Math.max(event.data.innerHeight,iframe.clientHeight)+'px'}
break;case 'resourceDomain':var domain=iframe.dataset.ccmDomain;iframe.contentWindow.postMessage({'action':action,'domain':domain},this.origin);break;case 'thirdPartyContentConsentGranted':var domain=iframe.dataset.ccmDomain;this.restoreIframe(iframe);this.iframes.forEach(function(iframe){if(iframe.dataset.ccmDomain==domain){self.restoreIframe(iframe)}});break;default:break}},getAllowedPurposes:function(){var consentStorage=this.getCookie(this.cookies.consent)||{};return consentStorage.purposes||[]},shouldBlockScript:function(node){if(this.inEval||!Utils.isJavaScript(node)||node.hasAttribute('data-ccm-injected')){return!1}
if(node.src){return(this.blockSameDomainScripts||Utils.checkIsExternal(node.src))}else{var text=String(node.outerHTML);var exception=this.allowedScriptMarkers.reduce(function(result,item){return(result||text.includes(item))},!1);return(!exception&&this.blockInlineScripts)}},purposesBlockingScript:function(node,purposes){if(!this.blockPurposeScriptMarkers){return!1}
if(this.inEval||!Utils.isJavaScript(node)||node.hasAttribute('data-ccm-injected')){return!1}
var text=String(node.outerHTML);var result=[];for(var purpose in this.blockPurposeScriptMarkers){if(!purposes.includes(purpose)){var block=this.blockPurposeScriptMarkers[purpose].reduce(function(result,marker){return(result||text.includes(marker))},!1);if(block){result.push(purpose)}}}
return result},observeDocument:function(){if(this.domWatcher){return}
var self=this;function onBeforeScriptExecute(event){var node=event.target;if(node.type=='text/x-blocked-script'){node.setAttribute('data-ccm-type',node.type);event.preventDefault()}}
if(self.blockScripts||self.blockPurposeScriptMarkers){addEvent(window,'beforescriptexecute',onBeforeScriptExecute,!0)}
function callback(mutations,observer){var purposes=self.getAllowedPurposes();mutations.forEach(function(mutation){Array.from(mutation.addedNodes).forEach(function(node){if(self.blockIframes&&node instanceof HTMLIFrameElement&&self.iframes.includes(node)==!1&&node.src){var text=String(node.outerHTML);var exception=self.allowedIframeMarkers.reduce(function(result,item){return(result||text.includes(item))},!1);if(node.src.substring(0,5)=='data:'){exception=!0}else if(node.src.substring(0,6)=='about:'){exception=!0}
if(!exception){node.dataset.ccmSrc=node.dataset.ccmSrc||node.src;node.dataset.ccmDomain=Utils.extractDomain(node.dataset.ccmSrc);node.src="https:\/\/www.tradingbrothers.com\/ccm19\/public\/x-content-blocked.html?apiKey=8662deeca87e5929ab9e3de6d9d0def93da5a2f8828890f5&domain=c2e7bbc&lang=de_DE"+'&url='+escape(node.src.replace(/[#].*$/,''));var clone=node.cloneNode();node.parentElement.insertBefore(clone,node);node.parentElement.removeChild(node);self.iframes.push(clone)}}else if(node instanceof HTMLScriptElement){var blockedByPurposes=self.purposesBlockingScript(node,purposes);var shouldBlock=self.shouldBlockScript(node);if(blockedByPurposes.length||shouldBlock){var contentToHash;if(node.src){contentToHash=String(node.src).trim().replace(/#.*$/i,"").replace(/\?.*/i,"?").replace(/\/(intl\/|releases\/|viewthroughconversion\/|www-widgetapi-)[^\/]+\//,'/$1…/')}else{contentToHash=String(node.innerHTML).trim().substring(1,1024).replace(/\s+/ig,' ')}
if(node.id){contentToHash+='#'+node.id.trim()}
if(node.className){contentToHash+='.'+node.className.trim()}
if(node.async){contentToHash+=':async'}
if(node.defer){contentToHash+=':defer'}
var hash=Utils.hash(contentToHash);var scriptIsAllowed=self.allowedScripts.includes(hash);if(blockedByPurposes.length||!scriptIsAllowed){var clone=node.cloneNode(!0);clone.ccm_id=hash;self.blockableScripts.push(clone);if(self.blockScripts||(self.isActive&&blockedByPurposes.length)){node.setAttribute('data-ccm-id',hash);if(node.src){console.debug("[CCM] Blocked script %s",node.src)}else{console.debug("[CCM] Blocked inline script %s…",node.innerText.trim().replace(/\s\s+/g,' ').substring(0,40))}
node.setAttribute('data-ccm-type',node.type);node.type='text/x-blocked-script';if(blockedByPurposes.length&&!(shouldBlock&&self.blockScripts&&!scriptIsAllowed)){console.debug("[CCM] Script may be unblocked by accepting purposes %s",blockedByPurposes.join(', '));clone.ccm_purposes=blockedByPurposes;clone.ccm_placeholder=node}}}}}})})};var options={attributes:!0,childList:!0,subtree:!0,characterData:!0};this.domWatcher=new MutationObserver(callback);this.domWatcher.observe(document,options);window.addEventListener('message',this.onPostMessage.bind(this))},init:function(){if(this.initialized){return}
var rand=Math.random();this.shouldReport=(rand<=0.333);if(this.shouldReport){this.wrapCookieSetter()}
this.observeDocument();this.injectCss();this.injectJs();var self=this;addEvent(window,'DOMContentLoaded',function(){self.build();document.body.appendChild(self.container)});this.initialized=!0},pageCheckReport:function(){var report={};report.c=this.getCookies().map(function(cookie){return cookie.name});var scripts=document.getElementsByTagName('script');report.s=[];for(var i=0;i<scripts.length;++i){var script=scripts[i];if(Utils.checkIsExternal(script.src)&&!script.hasAttribute('data-ccm-injected')){report.s.push(script.src)}}
var objects=document.getElementsByTagName('object');report.o=[];for(var i=0;i<objects.length;++i){var object=objects[i];if(Utils.checkIsExternal(object.data)){report.o.push(object.data)}}
objects=document.getElementsByTagName('embed');for(var i=0;i<objects.length;++i){object=objects[i];if(Utils.checkIsExternal(object.src)){report.o.push(object.src)}}
objects=document.getElementsByTagName('iframe');for(var i=0;i<objects.length;++i){object=objects[i];if(Utils.checkIsExternal(object.src)){report.o.push(object.src)}}
try{report.ls=[];var storage=window.localStorage;for(var i=0;i<storage.length;++i){report.ls.push(storage.key(i))}}catch(e){}
try{report.ss=[];var storage=window.sessionStorage;for(var i=0;i<storage.length;++i){report.ss.push(storage.key(i))}}catch(e){}
try{report.as={};var foundScriptCookies=this.foundScriptCookies;this.blockableScripts.forEach(function(node){var id=node.ccm_id;report.as[id]={s:node.outerHTML.trim().replace(/\s+\n/g,'\n').replace(/\n\n+/g,'\n\n').substring(0,500),c:((node.src in foundScriptCookies)?Object.keys(foundScriptCookies[node.src]):[])}})}catch(e){}
report.url=location.href.replace(/[?#].*$/,'');this.ajax(this.pageCheckUrl,{contentType:'application/json',body:report,method:'POST'})},triggerCron:function(){this.ajax(this.cronUrl,{method:'POST',})},deleteAllCookies:function(aftervar,purposes){var active_c={};var cookies=this.getCookies();var cname="";var purpose_id="";var is_to_del=!1;if(aftervar=="after"){for(var cookieId in this.repository){cname=(this.repository[cookieId].name);purpose_id=(this.repository[cookieId].purpose);purposes.forEach(function(pp){if(purpose_id==pp){active_c[cname]=cname}})}}else if(this.deleteAllCookiesConfig==!1){return}else{this.cookieDataActive.forEach(function(cka){cookies.forEach(function(ck){if(ck.name==cka){active_c[cka]=cka}})})}
active_c.ccm_login_session="ccm_login_session";active_c.ccm_consent="ccm_consent";var domains=[window.location.hostname];if(/^www\./.test(window.location.hostname)){domains.push(window.location.hostname.substr(3))}
cookies.forEach(function(ck,value){if(active_c[ck.name]){return!1}
domains.forEach(function(domain){document.cookie=ck.name+"="+";domain="+domain+";path=/"+";expires=Thu, 01 Jan 1970 00:00:00 UTC"});is_to_del=!0});if(this.deleteAllCookiesReload){if(is_to_del==!0){window.location.reload(!0)}}},wrapCookieSetter:function(){var self=this;if(!('getOwnPropertyDescriptor' in Object)){return}
var origDescriptor=null;var prototype=HTMLDocument.prototype;for(var i=0;(i<8)&&prototype;++i){prototype=Object.getPrototypeOf(prototype);origDescriptor=Object.getOwnPropertyDescriptor(prototype,'cookie');if(origDescriptor!==undefined){break}}
if(!origDescriptor){console.debug('[CCM] Browser incompatible; cannot trace cookie setting scripts')}
Object.defineProperty(document,'cookie',{get:function(){return origDescriptor.get.call(this)},set:function(value){try{var key=value.split('=',1)[0];var stack=((new Error()).stack.trim().split('\n'));stack.shift();if(stack.length>1&&/\/(js|jquery)\.cookie[._]/.test(stack[0])){stack.shift()}
if(stack.length>0){var m=stack[0].match(/\b((?:https?|data):.*):[0-9]+:[0-9]+\b/);if(m){if(!(m[1]in self.foundScriptCookies)){self.foundScriptCookies[m[1]]={}}
self.foundScriptCookies[m[1]][key]=key}}}catch(e){console.error('[CCM] Error while tracing cookie in script: %s',e)}
return origDescriptor.set.call(this,value)},enumerable:!0,configurable:!0})}};if(window.CCM===undefined){(function(){var ccm=new CookieConsentManagement();ccm.deleteAllCookies();window.CCM={get consent(){return ccm.consentGiven()},get ucid(){return this.consent?ccm.getUniqueCookieId():null},get acceptedCookies(){return ccm.cookiesEmbedded.map(function(cookieId){return ccm.repository[cookieId].name})},openWidget:function(){ccm.openWidget()},closeWidget:function(){ccm.closeWidget()},openControlPanel:function(){ccm.openControlPanel()},closeControlPanel:function(){ccm.closeControlPanel()},};var rand=Math.random();if(rand<=0.01){ccm.triggerCron()}
if(ccm.shouldReport){addEvent(window,'load',function(){window.setTimeout(ccm.pageCheckReport.bind(ccm),501)})}
addEvent(window,'DOMContentLoaded',function(){function doCCM(evt){try{var method=this.href.replace(/^.*#CCM\./,'');window.CCM[method].call(window.CCM);evt.preventDefault();return!1}catch(e){return}}
Array.from(document.body.querySelectorAll('a[href^="#CCM."]')).forEach(function(element){addEvent(element,'click',doCCM)})})})()}})()